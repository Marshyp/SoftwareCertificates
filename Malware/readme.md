Certificates used to sign malware or certificates swapped onto malware, most of these have been revoked  

Usage of a certificate on malware does NOT mean the company issuing the certficate has been compromised. Anyone can swap a certificate on an executable, however does not mean the certificate is valid.  


Ref: https://bazaar.abuse.ch/export/csv/cscb/

```

let CodeSigningBlockList = externaldata (line: string) [@'https://bazaar.abuse.ch/export/csv/cscb/'] with (format=txt, ignoreFirstRecord=true);
CodeSigningBlockList
| where line !startswith "#"
| extend all=split(replace_string(line,@'"',""),',') //easier than parse line
| extend  CertificateSerialNumber = all[1]
| extend  SignerHash  = tostring(all[2]) //Thumbprint
| extend Signer= (tostring(all[4]))
| extend  Issuer = tostring(all[5])
| project-away line,all
| join DeviceFileCertificateInfo on SignerHash  //Join unique records to devicefilecert events, showing results if the cert has been seen by MDE
//| join kind=leftouter DeviceProcessEvents on SHA1
//| join kind=leftouter DeviceFileEvents on SHA1

```
