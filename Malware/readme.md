Certificates used to sign malware or certificates swapped onto malware, most of these have been revoked  

Usage of a certificate on malware does NOT mean the company issuing the certficate has been compromised. Anyone can swap a certificate on an executable (examples of this [here](https://github.com/jkerai1/SoftwareCertificates/tree/ManipulatedExes/Manipulated%20Exes%20For%20Testing#post-testing), however does not mean the certificate is valid.  


Ref: https://bazaar.abuse.ch/export/csv/cscb/

```

let CodeSigningBlockList = externaldata (line: string) [@'https://bazaar.abuse.ch/export/csv/cscb/'] with (format=txt, ignoreFirstRecord=true);
CodeSigningBlockList
| where line !startswith "#"
| extend all=split(replace_string(line,@'"',""),',') //easier than parse line
| extend  CertificateSerialNumber = all[1]
| extend  SignerHash  = tostring(all[2]) //Thumbprint, may not be same algorithm in both tables
| extend Signer= (tostring(all[4]))
| extend  Issuer = tostring(all[5])
| project-away line,all
| join DeviceFileCertificateInfo on Signer  //Join unique records to devicefilecert events, showing results if the cert has been seen by MDE
//| where isnotempty(DeviceName)
//| join kind=leftouter DeviceProcessEvents on SHA1
//| join kind=leftouter DeviceFileEvents on SHA1

```

# Malware Bazaar Swagger
> Because I can't find the original source I am including this here

```
swagger: '2.0'
info:
  version: 1.0.0
  title: MalwareBazaar-API
  description: MalwareBazaar API query - https://bazaar.abuse.ch/api/
host: mb-api.abuse.ch
basePath: /
schemes:
  - https
consumes: []
produces:
  - application/json
paths:
  /api/v1/:
    post:
      summary: MalwareBazaar query
      description: MalwareBazaar API query - https://bazaar.abuse.ch/api/ [Free]
      operationId: malwarebazaar_query
      consumes:
        - application/x-www-form-urlencoded
      x-ms-visibility: important
      parameters:
        - in: formData
          name: query
          type: string
          required: true
          enum:
            - get_info
            - get_taginfo
            - get_siginfo
            - get_imphash
            - get_tlsh
            - get_issuerinfo
            - get_subjectinfo
        - in: formData
          name: hash
          type: string
        - in: formData
          name: tag
          type: string
        - in: formData
          name: limit
          type: integer
          default: 100
          minimum: 1
          maximum: 1000
        - in: formData
          name: imphash
          type: string
        - in: formData
          name: tlsh
          type: string
        - in: formData
          name: issuer_cn
          type: string
        - in: formData
          name: subject_cn
          type: string
      responses:
        default:
          description: default
          schema: {}
definitions: {}
parameters: {}
responses: {}
securityDefinitions: {}
security: []
tags: []
```
